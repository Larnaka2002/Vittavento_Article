<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>Vittavento Article Generator</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
</head>
<body>
    <div class="container">
        <h1>Vittavento Article Generator</h1>

        <form method="POST" action="{{ url_for('main.generator') }}">
            <div class="code-container">

                <div class="symbol-block group group-1">
                  <select class="symbol-select" name="view" onchange="if (this.value === 'add_new') window.location.href='/add_view'">
                    {% for v in views %}
                      <option value="{{ v.name }}">{{ v.name }}</option>
                    {% endfor %}
                    <option value="add_new">+ Добавить новый вид</option>
                  </select>
                </div>

                <div class="symbol-block group group-2">
                    <select name="category" class="symbol-select">
                        <option>BC</option>
                        <option>MI</option>
                        <option>GL</option>
                    </select>
                </div>

                <div class="symbol-block single">
                    <select name="level" class="symbol-select">
                       <option value="1">1</option>
                       <option value="2">2</option>
                       <option value="3">3</option>
                       <option value="4">4</option>
                    </select>
                </div>

                <div class="dash">-</div>

                <div class="symbol-block group group-2">
                    <select name="model" class="symbol-select">
                        <option>11</option>
                        <option>23</option>
                    </select>
                </div>

                <div class="symbol-block group group-2">
                    <select name="color" class="symbol-select">
                        <option>45</option>
                        <option>99</option>
                    </select>
                </div>

                <div class="symbol-block group group-3">
                    <select name="weight" class="symbol-select">
                        <option>123</option>
                        <option>345</option>
                    </select>
                </div>

                <div class="dash">-</div>

                <div class="symbol-block group group-2">
                    <select name="blocks" class="symbol-select">
                        <option>01</option>
                        <option>02</option>
                    </select>
                </div>

                <div class="symbol-block group group-2">
                    <select name="details" class="symbol-select">
                        <option>02</option>
                        <option>03</option>
                    </select>
                </div>

                <div class="dash">-</div>

                <div class="symbol-block single">
                    <select name="prefix" class="symbol-select">
                        <option value="1">1</option>
                        <option value="2">2</option>
                        <option value="3">3</option>
                    </select>
                </div>
            </div>
             <!-- Блок с описанием артикула -->
            <div class="form-group">
                <label for="article_description">Описание артикула</label>
                <textarea id="article_description" name="article_description" rows="3" placeholder="Введите описание..."></textarea>
            </div>
            <!-- Кнопки генерации и перехода -->
            <div class="button-container">
                <button type="submit" class="start-button">СГЕНЕРИРОВАТЬ</button>
                <a href="{{ url_for('main.list_articles') }}" class="start-button">Список артикулов</a>
            </div>
            <input type="hidden" name="article_code" id="article_code">

        </form>
    </div>
    <script>
        function handleViewChange(selectElement) {
            if (selectElement.value === "add_new") {
                window.location.href = "{{ url_for('main.add_view') }}";
            }
        }
    </script>
    <script>
      document.querySelector('form').addEventListener('submit', function(e) {
        const symbols = [...document.querySelectorAll('.symbol-select')];
        const rawCode = symbols.map(el => el.value).join('');
        const articleCode = [
            rawCode.slice(0, 4),     // первые 4 символа
            rawCode.slice(4, 11),    // с 5 по 11 символ
            rawCode.slice(11, 15),   // с 12 по 15
            rawCode.slice(15)        // всё, что после 15
        ].join('-');
        const descriptionField = document.getElementById('article_description');


        document.getElementById('article_code').value = articleCode;
        document.getElementById('article_description').value = description;

        descriptionField.value = '';
      });
    </script>
</body>
</html>
